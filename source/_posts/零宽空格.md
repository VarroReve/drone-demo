---
title: 零宽空格
date: 2019-07-19 18:26:54
tags: 坑
---

今天遇到了一个问题，有用户反馈说优惠券用不起，我拿优惠券去试了下，明明用的起啊，然后把优惠券用 PHP 的函数 urlencode() 之后发现了区别。

```
// 正常的优惠券
b4c44af562

// urlencode() 之后
b4c44af562


// 有问题的优惠券
b4c44af562​​​​​​​​​​​​​​

// urlencode() 之后
b4c44af562%e2%80%8b%e2%80%8b%e2%80%8b%e2%80%8b%e2%80%8b%e2%80%8b%e2%80%8b%e2%80%8b%e2%80%8b%e2%80%8b%e2%80%8b%e2%80%8b%e2%80%8b%e2%80%8b
```

用审查元素 (F12) 查看第二个优惠券，可以看到第二个优惠券后跟了许多 `&#8203`：

```
<span class="line">b4c44af562&#8203;&#8203;&#8203;&#8203;&#8203;&#8203;&#8203;&#8203;&#8203;&#8203;&#8203;&#8203;&#8203;&#8203;</span>
```

![](https://s2.ax1x.com/2019/07/19/Zxneu6.png)


用户使用这个优惠券的时候将 `&#8203` 一并提交了，而数据库中又没有这个优惠券，所以用不起。

谷歌了下，这个东西叫做 [零宽空格](https://zh.wikipedia.org/wiki/%E9%9B%B6%E5%AE%BD%E7%A9%BA%E6%A0%BC)。一般的空格是有宽度的，使用光标可以将它选中。但零宽空格没有宽度，看不见，也难以选中，就像不存在一样。

零宽空格一般用于可能需要换行的地方，但用它可以搞点别的事情出来。

比如说在一个网站、游戏中，自己想注册的昵称被占用了，可以在想要的昵称后面跟个零宽空格就注册的了了（假如这个网站没有过滤掉这种特殊字符），缺点是别人也很难通过昵称搜索到你了。或者可以起一个完全「空白」的昵称。

试了下，在微信中不可以起带零宽空格的昵称，但是在 QQ 中可以，所以我的 QQ 昵称就变成「空白」的了：

![](https://s2.ax1x.com/2019/07/19/ZxmBX6.jpg)

![](https://s2.ax1x.com/2019/08/09/eboXIH.png)

或者在微信中发送空白内容的消息：

![](https://s2.ax1x.com/2019/07/19/ZxnPN4.jpg)

平时在开发中处理用户输入时一定要做好「过滤」、「验证」、「转义」，鬼知道他们会提交什么神仙东西进来（笑）。